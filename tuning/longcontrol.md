# 롱컨 튜닝

## 기본설정

* 당근맨 설정 접속
* 화면 -> 디버그플롯을 1로 설정
  * <mark style="color:green;">녹색</mark> : **이상적인 가속도**
  * <mark style="color:yellow;">노랑</mark> : **차량의 가속도**
  * <mark style="color:orange;">주황</mark> : **차량의 명령**

## Longitudinal Actuator Delay 튜닝

* KiV와 KpV는 0으로 두고 튜닝
* 정지 출발을 제외하고, 등속과 가속 상황에서 **노란색이 녹색을 잘 따라가는 것**이 가장 이상적인 그래프
* 노란색이 늦게 따라간다면, LAD를 올려서 조절
* 속도가 출렁이지 않게 LAD 조절이 끝나면, KpV값을 100부터 시작하여 녹색과 노란색이 비슷하게 조절

( LAD가 잘 맞는 상태라면, KpV가 100으로 딱 맞음)

**모든 설정은 실시간 적용**

## <mark style="background-color:purple;">LAD (Longitudinal Actuator Delay) 가 너무 높으면?</mark>

* 노란색(현재가속도)가 녹색(목표가속도)를 이겨버리는 현상 발생
* 급정거가 많이 발생하고, 속도의 출렁임이 발생함

## Radar reaction factor

* 레이더에 대한 반응의 민감도입니다. (현재 Vision레이더는 고정되어 있음)
* 레이더에 대한 주행예측을 Threshold와 Tau라는 값으로 예측하게 됩니다. 이 값을 조절하여, 전방차량 주행을 예측하게 됩니다.
* Threshhold의 기본값은 0.5 m/s^2 인데, 전방차량의 가속도가 이 값보다 작으면 별일 없는 것으로 내차의 주행패턴의 변화를 최소화합니다. 하지만, 이것때문에 급감속시 늦은 감속을 시작하게 됩니다.
* Tau값은 1.5입니다. 전방차량이 약 4초정도만 가감속을 한다는 것을 의미합니다. 이값을 줄이면, 좀더 지속적으로 가감속을 한다는것으로 판단하게 됩니다.
* **적은 값으로 사용하면 전방차량에 대해 반응이 민감해집니다.**
* 당근파일럿의 기본값은10%이고, 콤마는 100% 입니다.\\

## Comfort Brake

* Comfort Brake의 **기본값은 250**이다.
* Comfort Brake의 값을 낮출수록, 전방차량이 있을 때 먼저 감속을 한다.
* 즉, 값이 **낮을수록 더 부드럽게 정지**한다.
* 단, 너무 낮은 값을 사용하면 전방차량과 과도하게 넓은 안전거리를 두게된다.
* 따라서, **230\~240 정도가 추천 설정 값**이다.
